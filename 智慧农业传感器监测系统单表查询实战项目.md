# 智慧农业传感器监测系统单表查询实战项目

（基于SQL单表查询核心知识点）

---

## 一、项目定位

严格遵循“关系数据库标准语言SQL-3.3查询”章节核心知识点，以智慧农业传感器监测为新工科典型场景，聚焦单表查询全流程实操，覆盖选择列、选择元组、排序、集函数等所有单表查询技术点，通过农业物联网实际监测需求，巩固SQL语法应用，适配数据库课程与新工科实践结合的教学目标。

---

## 二、项目背景

智慧农业是新工科重点落地领域，传感器监测系统是其核心数据采集载体。本项目基于农田传感器实时监测单表，通过单表查询实现传感器状态核查、环境数据筛选、异常值统计等高频工程需求，所有场景均贴合农业物联网实际运维工作，且完全匹配SQL查询语法规范。

---

## 三、核心知识点（100%源自SQL课程知识点）

|知识点类别|具体内容及语法规范|
|---|---|
|SQL查询基本格式|`SELECT [ALL|DISTINCT] <目标列表达式> … FROM <表名> [WHERE <条件表达式>] [ORDER BY <列名1> [ASC|DESC]]`|
|选择表中的若干列|- 指定列查询：`SELECT 列1, 列2 FROM 表名`- 所有列查询：`SELECT * FROM 表名`|
|选择表中的若干元组|1. 去重：DISTINCT短语（消除重复行）2. WHERE子句支持的查询条件及谓词：   - 比较大小：=、>、<、>=、<=、<>（不等于）   - 确定范围：BETWEEN...AND...、NOT BETWEEN...AND...   - 字符匹配：LIKE（%代表任意长度字符串，_代表单个字符）   - 空值判断：IS NULL、IS NOT NULL   - 多重条件：AND、OR|
|查询结果排序|ORDER BY子句，ASC（默认升序）、DESC（降序），支持多列排序|
|集函数应用|COUNT（计数）、SUM（求和）、AVG（平均值）、MAX（最大值）、MIN（最小值），支持DISTINCT/ALL短语|
---

## 四、数据库设计（新工科场景单表）

### 1. 表结构定义（贴合农业物联网监测需求）

|字段名|数据类型|字段说明|约束要求|
|---|---|---|---|
|monitor_id|INT(11)|监测记录唯一ID|非空、自增（主键）|
|sensor_id|VARCHAR(20)|传感器编号（如：S202501、S202508）|非空|
|monitor_type|VARCHAR(20)|监测类型（温度、湿度、土壤含水量）|非空|
|monitor_value|DECIMAL(6,2)|监测数值（温度：℃；湿度：%）|非空|
|monitor_time|DATETIME|监测时间|非空（格式：YYYY-MM-DD HH:MM:SS）|
|location|VARCHAR(30)|安装位置（如：东区农田、西区大棚）|非空|
|status|VARCHAR(10)|设备状态（正常、异常、离线）|可为空（离线时为NULL）|
### 2. 测试数据插入SQL代码

```sql

-- 创建数据库
CREATE DATABASE IF NOT EXISTS smart_agriculture;
USE smart_agriculture;

-- 建表（按字段约束规范）
CREATE TABLE IF NOT EXISTS sensor_monitor (
    monitor_id INT(11) PRIMARY KEY AUTO_INCREMENT,
    sensor_id VARCHAR(20) NOT NULL,
    monitor_type VARCHAR(20) NOT NULL,
    monitor_value DECIMAL(6,2) NOT NULL,
    monitor_time DATETIME NOT NULL,
    location VARCHAR(30) NOT NULL,
    status VARCHAR(10) NULL
);

-- 插入测试数据（覆盖不同监测类型、状态、数值范围）
INSERT INTO sensor_monitor 
(sensor_id, monitor_type, monitor_value, monitor_time, location, status)
VALUES
('S202501', '温度', 25.30, '2025-11-01 08:00:00', '东区农田', '正常'),
('S202502', '湿度', 65.20, '2025-11-01 08:00:00', '东区农田', '正常'),
('S202503', '土壤含水量', 22.50, '2025-11-01 09:00:00', '西区大棚', '正常'),
('S202501', '温度', 26.80, '2025-11-01 10:00:00', '东区农田', '正常'),
('S202504', '温度', 32.10, '2025-11-01 10:00:00', '南区果园', '异常'),
('S202502', '湿度', 58.70, '2025-11-01 11:00:00', '东区农田', '正常'),
('S202505', '土壤含水量', 18.30, '2025-11-01 11:00:00', '西区大棚', NULL),
('S202503', '土壤含水量', 23.10, '2025-11-02 08:00:00', '西区大棚', '正常'),
('S202506', '湿度', 45.90, '2025-11-02 09:00:00', '南区果园', '正常'),
('S202504', '温度', 33.50, '2025-11-02 10:00:00', '南区果园', '异常'),
('S202507', '温度', 24.70, '2025-11-02 10:00:00', '北区菜地', '正常'),
('S202508', '湿度', 72.30, '2025-11-02 11:00:00', '北区菜地', NULL);
```

---

## 五、查询需求（精准匹配核心知识点）

### 需求1：基础列选择（对应“选择表中的若干列”）

#### 场景

查询所有监测记录的传感器编号、监测类型和数值（农业运维基础数据统计）

#### SQL代码

```sql

SELECT sensor_id, monitor_type, monitor_value 
FROM sensor_monitor;
```

#### 知识点匹配

选择表中的若干列——指定目标列表达式，不查询冗余字段。

### 需求2：去重查询（对应“选择表中的若干元组-DISTINCT”）

#### 场景

查询已部署的所有传感器编号（避免重复统计）

#### SQL代码

```sql

SELECT DISTINCT sensor_id 
FROM sensor_monitor;
```

#### 知识点匹配

DISTINCT短语消除重复行，对应实际运维中设备清单统计需求。

### 需求3：比较条件查询（对应“选择元组-比较大小”）

#### 场景

查询温度高于30℃的异常监测记录（农业高温预警筛选）

#### SQL代码

```sql

SELECT * 
FROM sensor_monitor 
WHERE monitor_type = '温度' AND monitor_value > 30;
```

#### 知识点匹配

比较运算符（>）+ 多重条件（AND），适配工程异常筛选场景。

### 需求4：范围查询（对应“选择元组-确定范围”）

#### 场景

查询土壤含水量在20%~25%之间的正常记录（适宜作物生长湿度筛选）

#### SQL代码

```sql

SELECT sensor_id, monitor_value, location 
FROM sensor_monitor 
WHERE monitor_type = '土壤含水量' 
  AND monitor_value BETWEEN 20 AND 25 
  AND status = '正常';
```

#### 知识点匹配

BETWEEN...AND...谓词，精准筛选数值范围。

### 需求5：模糊查询（对应“选择元组-字符匹配”）

#### 场景

查询编号以“S20250”开头且安装在“农田”区域的传感器记录

#### SQL代码

```sql

SELECT * 
FROM sensor_monitor 
WHERE sensor_id LIKE 'S20250%' 
  AND location LIKE '%农田%';
```

#### 知识点匹配

LIKE通配符（%），实现模糊匹配查询。

### 需求6：空值查询（对应“选择元组-空值”）

#### 场景

查询设备状态为空（离线）的传感器监测记录（运维故障排查）

#### SQL代码

```sql

SELECT sensor_id, monitor_time, location 
FROM sensor_monitor 
WHERE status IS NULL;
```

#### 知识点匹配

IS NULL谓词，处理缺失值场景。

### 需求7：排序查询（对应“查询结果排序”）

#### 场景

查询西区大棚的湿度监测记录，按监测时间降序排列（最新数据优先）

#### SQL代码

```sql

SELECT * 
FROM sensor_monitor 
WHERE location = '西区大棚' AND monitor_type = '湿度' 
ORDER BY monitor_time DESC;
```

#### 知识点匹配

ORDER BY子句，DESC降序排列，适配工程数据时效性需求。

### 需求8：集函数查询（对应“使用集函数”）

#### 场景

统计东区农田温度监测的平均值、最高值和记录总数（环境趋势分析）

#### SQL代码

```sql

SELECT 
  AVG(monitor_value) AS avg_temperature,
  MAX(monitor_value) AS max_temperature,
  COUNT(*) AS total_records
FROM sensor_monitor 
WHERE location = '东区农田' AND monitor_type = '温度';
```

#### 知识点匹配

AVG/MAX/COUNT集函数，实现数据统计分析。

### 需求9：多重条件组合查询（对应“选择元组-多重条件”）

#### 场景

查询2025年11月2日期间，南区果园或北区菜地的正常状态监测记录

#### SQL代码

```sql

SELECT * 
FROM sensor_monitor 
WHERE monitor_time BETWEEN '2025-11-02 00:00:00' AND '2025-11-02 23:59:59'
  AND (location = '南区果园' OR location = '北区菜地')
  AND status = '正常';
```

#### 知识点匹配

AND/OR组合条件，复杂场景精准筛选。

---

## 六、新工科拓展方向（产业融合）

- **工程化落地**：结合Python（pymysql）将异常数据查询结果推送至农业物联网平台，实现高温、离线设备自动预警。

- **数据可视化**：用Matplotlib将集函数查询结果绘制成“区域温度变化折线图”，辅助农田灌溉、遮阳决策。

- **查询优化**：针对高频筛选字段（monitor_type、location）添加索引（`CREATE INDEX idx_monitor_type ON sensor_monitor(monitor_type);`），提升海量监测数据查询效率。

- **场景延伸**：基于单表结构扩展“传感器维保表”，为后续多表关联查询（新工科进阶能力）铺垫。

---

## 七、项目考核要点（贴合教学目标）

- 能否根据农业监测需求灵活调整查询条件（如修改温度阈值、区域名称）。

- 能否正确应用所有单表查询知识点，规避语法错误（如空值判断、通配符使用）。

- 能否解读查询结果的工程意义（如异常温度需启动遮阳设备）。

- 能否优化查询语句，适配大规模传感器数据存储场景。

---

**说明**：本项目所有SQL代码均可直接在MySQL等关系型数据库中执行，测试数据覆盖各类查询场景，可直接用于课程实践、实验报告或自学练习。
> （注：文档部分内容可能由 AI 生成）